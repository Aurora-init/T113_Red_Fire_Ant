###############################################################################
#
# IAR C/C++ Compiler V10.10.1.4655 for 8051               26/Mar/2023  16:31:30
# Copyright 2004-2017 IAR Systems AB.
# Standalone license - IAR Embedded Workbench for 8051
#
#    Core               =  plain
#    Code model         =  banked
#    Data model         =  large
#    Calling convention =  xdata reentrant
#    Constant location  =  data_rom
#    Dptr setup         =  1,16
#                          
#    Source file        =  
#        D:\桌面\《ZigBee3.0开发指南》配套资源（附加部分）\课外篇：项目实战\基于Zigbee的温湿度
#        & 光照度采集系统\ZigBee设备端固件与源码\源码\Applications\zb_common.c
#    Command line       =  
#        -f C:\Users\11148\AppData\Local\Temp\EWDC94.tmp
#        ("D:\桌面\《ZigBee3.0开发指南》配套资源（附加部分）\课外篇：项目实战\基于Zigbee的温湿度
#        & 光照度采集系统\ZigBee设备端固件与源码\源码\Applications\zb_common.c"
#        -D SECURE=1 -D TC_LINKKEY_JOIN -D NV_INIT -D NV_RESTORE -D xZTOOL_P1
#        -D xMT_TASK -D xMT_APP_FUNC -D xMT_SYS_FUNC -D xMT_ZDO_FUNC -D
#        xMT_ZDO_MGMT -D xMT_APP_CNF_FUNC -D LCD_SUPPORTED=DEBUG -D
#        MULTICAST_ENABLED=FALSE -D ZCL_READ -D ZCL_DISCOVER -D ZCL_WRITE -D
#        ZCL_BASIC -D ZCL_IDENTIFY -D ZCL_ON_OFF -D ZCL_GROUPS -D
#        ZCL_LEVEL_CTRL -D HAL_KEY=FALSE -D xISR_KEYINTERRUPT -D HAL_UART=TRUE
#        -D INT_HEAP_LEN=2048 -D HAL_LCD=TRUE -D HAL_LCD_OLED12864=TRUE -D
#        HAL_ADC=TRUE -D HAL_DHT11=TRUE -lC
#        "D:\桌面\《ZigBee3.0开发指南》配套资源（附加部分）\课外篇：项目实战\基于Zigbee的温湿度
#        &
#        光照度采集系统\ZigBee设备端固件与源码\源码\Projects\CC2530\Category\Router\List"
#        -lA
#        "D:\桌面\《ZigBee3.0开发指南》配套资源（附加部分）\课外篇：项目实战\基于Zigbee的温湿度
#        &
#        光照度采集系统\ZigBee设备端固件与源码\源码\Projects\CC2530\Category\Router\List"
#        --diag_suppress Pe001,Pa010 -o
#        "D:\桌面\《ZigBee3.0开发指南》配套资源（附加部分）\课外篇：项目实战\基于Zigbee的温湿度
#        &
#        光照度采集系统\ZigBee设备端固件与源码\源码\Projects\CC2530\Category\Router\Obj"
#        -e --debug --core=plain --dptr=16,1 --data_model=large
#        --code_model=banked --calling_convention=xdata_reentrant
#        --place_constants=data_rom --nr_virtual_regs 16 -f
#        "D:\桌面\《ZigBee3.0开发指南》配套资源（附加部分）\课外篇：项目实战\基于Zigbee的温湿度
#        &
#        光照度采集系统\ZigBee设备端固件与源码\源码\Projects\CC2530\Tools\f8wRouter.cfg"
#        (-DCPU32MHZ -DROOT=__near_func -DMAC_CFG_APP_PENDING_QUEUE=TRUE
#        -DMAC_CFG_TX_DATA_MAX=5 -DMAC_CFG_TX_MAX=8 -DMAC_CFG_RX_MAX=5
#        -DRTR_NWK) -f
#        "D:\桌面\《ZigBee3.0开发指南》配套资源（附加部分）\课外篇：项目实战\基于Zigbee的温湿度
#        &
#        光照度采集系统\ZigBee设备端固件与源码\源码\Projects\CC2530\Tools\f8wConfig.cfg"
#        (-DZIGBEEPRO -DSECURE=1 -DZG_SECURE_DYNAMIC=0 -DREFLECTOR
#        -DDEFAULT_CHANLIST=0x00000800 -DZDAPP_CONFIG_PAN_ID=0x0402
#        -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MASK=0x007F
#        -DBEACON_REQUEST_DELAY=100 -DBEACON_REQ_DELAY_MASK=0x00FF
#        -DLINK_STATUS_JITTER_MASK=0x007F -DROUTE_EXPIRY_TIME=30
#        -DAPSC_ACK_WAIT_DURATION_POLLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7
#        -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3
#        -DNWK_MAX_DATA_RETRIES=2 -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9
#        -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40 -DNWK_MAX_BINDING_ENTRIES=4
#        -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x5a, 0x69, 0x67, 0x42,
#        0x65,0x65, 0x41, 0x6c, 0x6c, 0x69, 0x61, 0x6e, 0x63, 0x65, 0x30,
#        0x39}" -DMAC_MAX_FRAME_SIZE=116 -DZDNWKMGR_MIN_TRANSMISSIONS=20
#        "-DCONST=const __code" -DGENERIC=__generic -DRFD_RCVC_ALWAYS_ON=FALSE
#        -DPOLL_RATE=1000 -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100
#        -DREJOIN_POLL_RATE=440 -DREJOIN_BACKOFF=900000 -DREJOIN_SCAN=900000
#        -DENABLE_LED4_DISABLE_S1) -f
#        "D:\桌面\《ZigBee3.0开发指南》配套资源（附加部分）\课外篇：项目实战\基于Zigbee的温湿度
#        &
#        光照度采集系统\ZigBee设备端固件与源码\源码\Projects\CC2530\Tools\f8wZCL.cfg"
#        -I
#        "D:\桌面\《ZigBee3.0开发指南》配套资源（附加部分）\课外篇：项目实战\基于Zigbee的温湿度
#        & 光照度采集系统\ZigBee设备端固件与源码\源码\Projects\CC2530\" -I
#        "D:\桌面\《ZigBee3.0开发指南》配套资源（附加部分）\课外篇：项目实战\基于Zigbee的温湿度
#        &
#        光照度采集系统\ZigBee设备端固件与源码\源码\Projects\CC2530\..\..\Components\hal\include\"
#        -I
#        "D:\桌面\《ZigBee3.0开发指南》配套资源（附加部分）\课外篇：项目实战\基于Zigbee的温湿度
#        &
#        光照度采集系统\ZigBee设备端固件与源码\源码\Projects\CC2530\..\..\Components\hal\target\CC2530EB\"
#        -I
#        "D:\桌面\《ZigBee3.0开发指南》配套资源（附加部分）\课外篇：项目实战\基于Zigbee的温湿度
#        &
#        光照度采集系统\ZigBee设备端固件与源码\源码\Projects\CC2530\..\..\Components\hal\userspace\"
#        -I
#        "D:\桌面\《ZigBee3.0开发指南》配套资源（附加部分）\课外篇：项目实战\基于Zigbee的温湿度
#        &
#        光照度采集系统\ZigBee设备端固件与源码\源码\Projects\CC2530\..\..\Components\mac\include\"
#        -I
#        "D:\桌面\《ZigBee3.0开发指南》配套资源（附加部分）\课外篇：项目实战\基于Zigbee的温湿度
#        &
#        光照度采集系统\ZigBee设备端固件与源码\源码\Projects\CC2530\..\..\Components\mac\high_level\"
#        -I
#        "D:\桌面\《ZigBee3.0开发指南》配套资源（附加部分）\课外篇：项目实战\基于Zigbee的温湿度
#        &
#        光照度采集系统\ZigBee设备端固件与源码\源码\Projects\CC2530\..\..\Components\mac\low_level\srf04\"
#        -I
#        "D:\桌面\《ZigBee3.0开发指南》配套资源（附加部分）\课外篇：项目实战\基于Zigbee的温湿度
#        &
#        光照度采集系统\ZigBee设备端固件与源码\源码\Projects\CC2530\..\..\Components\mac\low_level\srf04\single_chip\"
#        -I
#        "D:\桌面\《ZigBee3.0开发指南》配套资源（附加部分）\课外篇：项目实战\基于Zigbee的温湿度
#        &
#        光照度采集系统\ZigBee设备端固件与源码\源码\Projects\CC2530\..\..\Components\mt\"
#        -I
#        "D:\桌面\《ZigBee3.0开发指南》配套资源（附加部分）\课外篇：项目实战\基于Zigbee的温湿度
#        &
#        光照度采集系统\ZigBee设备端固件与源码\源码\Projects\CC2530\..\..\Components\osal\include\"
#        -I
#        "D:\桌面\《ZigBee3.0开发指南》配套资源（附加部分）\课外篇：项目实战\基于Zigbee的温湿度
#        &
#        光照度采集系统\ZigBee设备端固件与源码\源码\Projects\CC2530\..\..\Components\services\saddr\"
#        -I
#        "D:\桌面\《ZigBee3.0开发指南》配套资源（附加部分）\课外篇：项目实战\基于Zigbee的温湿度
#        &
#        光照度采集系统\ZigBee设备端固件与源码\源码\Projects\CC2530\..\..\Components\services\sdata\"
#        -I
#        "D:\桌面\《ZigBee3.0开发指南》配套资源（附加部分）\课外篇：项目实战\基于Zigbee的温湿度
#        &
#        光照度采集系统\ZigBee设备端固件与源码\源码\Projects\CC2530\..\..\Components\stack\af\"
#        -I
#        "D:\桌面\《ZigBee3.0开发指南》配套资源（附加部分）\课外篇：项目实战\基于Zigbee的温湿度
#        &
#        光照度采集系统\ZigBee设备端固件与源码\源码\Projects\CC2530\..\..\Components\stack\bdb\"
#        -I
#        "D:\桌面\《ZigBee3.0开发指南》配套资源（附加部分）\课外篇：项目实战\基于Zigbee的温湿度
#        &
#        光照度采集系统\ZigBee设备端固件与源码\源码\Projects\CC2530\..\..\Components\stack\gp\"
#        -I
#        "D:\桌面\《ZigBee3.0开发指南》配套资源（附加部分）\课外篇：项目实战\基于Zigbee的温湿度
#        &
#        光照度采集系统\ZigBee设备端固件与源码\源码\Projects\CC2530\..\..\Components\stack\nwk\"
#        -I
#        "D:\桌面\《ZigBee3.0开发指南》配套资源（附加部分）\课外篇：项目实战\基于Zigbee的温湿度
#        &
#        光照度采集系统\ZigBee设备端固件与源码\源码\Projects\CC2530\..\..\Components\stack\sapi\"
#        -I
#        "D:\桌面\《ZigBee3.0开发指南》配套资源（附加部分）\课外篇：项目实战\基于Zigbee的温湿度
#        &
#        光照度采集系统\ZigBee设备端固件与源码\源码\Projects\CC2530\..\..\Components\stack\sec\"
#        -I
#        "D:\桌面\《ZigBee3.0开发指南》配套资源（附加部分）\课外篇：项目实战\基于Zigbee的温湿度
#        &
#        光照度采集系统\ZigBee设备端固件与源码\源码\Projects\CC2530\..\..\Components\stack\sys\"
#        -I
#        "D:\桌面\《ZigBee3.0开发指南》配套资源（附加部分）\课外篇：项目实战\基于Zigbee的温湿度
#        &
#        光照度采集系统\ZigBee设备端固件与源码\源码\Projects\CC2530\..\..\Components\stack\zcl\"
#        -I
#        "D:\桌面\《ZigBee3.0开发指南》配套资源（附加部分）\课外篇：项目实战\基于Zigbee的温湿度
#        &
#        光照度采集系统\ZigBee设备端固件与源码\源码\Projects\CC2530\..\..\Components\stack\zdo\"
#        -I
#        "D:\桌面\《ZigBee3.0开发指南》配套资源（附加部分）\课外篇：项目实战\基于Zigbee的温湿度
#        &
#        光照度采集系统\ZigBee设备端固件与源码\源码\Projects\CC2530\..\..\Components\zmac\"
#        -I
#        "D:\桌面\《ZigBee3.0开发指南》配套资源（附加部分）\课外篇：项目实战\基于Zigbee的温湿度
#        &
#        光照度采集系统\ZigBee设备端固件与源码\源码\Projects\CC2530\..\..\Components\zmac\f8w\"
#        -I
#        "D:\桌面\《ZigBee3.0开发指南》配套资源（附加部分）\课外篇：项目实战\基于Zigbee的温湿度
#        &
#        光照度采集系统\ZigBee设备端固件与源码\源码\Projects\CC2530\..\..\Applications\"
#        -Ohz --require_prototypes)
#    Locale             =  Chinese (Simplified)_China.936
#    List file          =  
#        D:\桌面\《ZigBee3.0开发指南》配套资源（附加部分）\课外篇：项目实战\基于Zigbee的温湿度
#        &
#        光照度采集系统\ZigBee设备端固件与源码\源码\Projects\CC2530\Category\Router\List\zb_common.lst
#    Object file        =  
#        D:\桌面\《ZigBee3.0开发指南》配套资源（附加部分）\课外篇：项目实战\基于Zigbee的温湿度
#        &
#        光照度采集系统\ZigBee设备端固件与源码\源码\Projects\CC2530\Category\Router\Obj\zb_common.r51
#
###############################################################################

D:\桌面\《ZigBee3.0开发指南》配套资源（附加部分）\课外篇：项目实战\基于Zigbee的温湿度 & 光照度采集系统\ZigBee设备端固件与源码\源码\Applications\zb_common.c
      1          #include "zb_common.h"
      2          
      3          #define MAX3(a,b,c) (((a) > (b)) ? ( ((a) > (c)) ? (a) : (c) ) : ( ((b) > (c)) ? (b) : (c) ))
      4          #define MIN3(a,b,c) (((a) > (b)) ? ( ((b) > (c)) ? (c) : (b) ) : ( ((a) > (c)) ? (c) : (a) ))
      5          
      6          static void invert_to_uint8(uint8_t src_char, uint8_t *dest_char)
      7          { 
      8              uint8_t tmp = 0;
      9          
     10              uint8_t i;
     11              for (i = 0; i < 8; i++) if (src_char & (1 << i)) tmp |= 1 << (7-i);
     12          
     13              *dest_char = tmp;
     14          }  
     15          
     16          static void invert_to_uint16(uint16_t src_dat, uint16_t *dest_dat)
     17          {  
     18              uint16_t tmp = 0;
     19          
     20              uint8_t i;
     21              for (i = 0; i < 16; i++) if (src_dat & (1 << i)) tmp |= 1 << (15 - i);
     22          
     23              *dest_dat = tmp;
     24          }  
     25          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
     26          uint16_t crc16_x25(const uint8_t *buf, uint16_t buf_len)
   \                     crc16_x25:
     27          {
   \   000000                REQUIRE ?V0
   \   000000                REQUIRE ?V1
   \   000000   74F6         MOV       A,#-0xa
   \   000002   12....       LCALL     ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   8A82         MOV       DPL,R2
   \   000007   8B83         MOV       DPH,R3
     28              uint16_t result = 0xFFFF;
   \   000009   7AFF         MOV       R2,#-0x1
   \   00000B   7BFF         MOV       R3,#-0x1
     29              uint16_t poly   = 0x1021;
     30              uint8_t  wchar  = 0;  
     31          
     32              while (buf_len--) {
   \                     ??crc16_x25_0:
   \   00000D   EC           MOV       A,R4
   \   00000E   F8           MOV       R0,A
   \   00000F   ED           MOV       A,R5
   \   000010   F9           MOV       R1,A
   \   000011   E8           MOV       A,R0
   \   000012   24FF         ADD       A,#-0x1
   \   000014   1C           DEC       R4
   \   000015   E9           MOV       A,R1
   \   000016   34FF         ADDC      A,#-0x1
   \   000018   FD           MOV       R5,A
   \   000019   E8           MOV       A,R0
   \   00001A   49           ORL       A,R1
   \   00001B   605A         JZ        ??crc16_x25_1
     33                  wchar = *(buf++);
   \   00001D   E0           MOVX      A,@DPTR
   \   00001E   FF           MOV       R7,A
   \   00001F   A3           INC       DPTR
     34                  invert_to_uint8(wchar, &wchar);
   \   000020   7900         MOV       R1,#0x0
   \   000022   7E00         MOV       R6,#0x0
   \                     ??crc16_x25_2:
   \   000024   75..01       MOV       ?V0,#0x1
   \   000027   75..00       MOV       ?V1,#0x0
   \   00002A   EE           MOV       A,R6
   \   00002B   78..         MOV       R0,#?V0
   \   00002D   12....       LCALL     ?S_SHL
   \   000030   E5..         MOV       A,?V0
   \   000032   5F           ANL       A,R7
   \   000033   6014         JZ        ??crc16_x25_3
   \   000035   75..01       MOV       ?V0,#0x1
   \   000038   75..00       MOV       ?V1,#0x0
   \   00003B   7407         MOV       A,#0x7
   \   00003D   C3           CLR       C
   \   00003E   9E           SUBB      A,R6
   \   00003F   78..         MOV       R0,#?V0
   \   000041   12....       LCALL     ?S_SHL
   \   000044   E5..         MOV       A,?V0
   \   000046   C9           XCH       A,R1
   \   000047   49           ORL       A,R1
   \   000048   F9           MOV       R1,A
   \                     ??crc16_x25_3:
   \   000049   0E           INC       R6
   \   00004A   EE           MOV       A,R6
   \   00004B   C3           CLR       C
   \   00004C   9408         SUBB      A,#0x8
   \   00004E   40D4         JC        ??crc16_x25_2
     35          
     36                  result ^= (wchar << 8);
   \   000050   E9           MOV       A,R1
   \   000051   6B           XRL       A,R3
   \   000052   FB           MOV       R3,A
     37          
     38                  uint8_t i;
     39                  for (i = 0; i < 8; i++)
   \   000053   7E08         MOV       R6,#0x8
     40                      if(result & 0x8000) result = (result << 1) ^ poly;
   \                     ??crc16_x25_4:
   \   000055   EA           MOV       A,R2
   \   000056   F8           MOV       R0,A
   \   000057   EB           MOV       A,R3
   \   000058   F9           MOV       R1,A
   \   000059   E8           MOV       A,R0
   \   00005A   28           ADD       A,R0
   \   00005B   F8           MOV       R0,A
   \   00005C   E9           MOV       A,R1
   \   00005D   33           RLC       A
   \   00005E   F9           MOV       R1,A
   \   00005F   EB           MOV       A,R3
   \   000060   5480         ANL       A,#0x80
   \   000062   6009         JZ        ??crc16_x25_5
   \   000064   E8           MOV       A,R0
   \   000065   6421         XRL       A,#0x21
   \   000067   FA           MOV       R2,A
   \   000068   E9           MOV       A,R1
   \   000069   6410         XRL       A,#0x10
   \   00006B   8003         SJMP      ??crc16_x25_6
     41                      else result = result << 1;
   \                     ??crc16_x25_5:
   \   00006D   E8           MOV       A,R0
   \   00006E   FA           MOV       R2,A
   \   00006F   E9           MOV       A,R1
   \                     ??crc16_x25_6:
   \   000070   FB           MOV       R3,A
   \   000071   1E           DEC       R6
   \   000072   EE           MOV       A,R6
   \   000073   6098         JZ        ??crc16_x25_0
   \   000075   80DE         SJMP      ??crc16_x25_4
     42              }
     43          
     44              invert_to_uint16(result, &result);
   \                     ??crc16_x25_1:
   \   000077   7C00         MOV       R4,#0x0
   \   000079   7D00         MOV       R5,#0x0
   \   00007B   7900         MOV       R1,#0x0
   \                     ??crc16_x25_7:
   \   00007D   8A..         MOV       ?V0,R2
   \   00007F   8B..         MOV       ?V1,R3
   \   000081   E9           MOV       A,R1
   \   000082   78..         MOV       R0,#?V0
   \   000084   12....       LCALL     ?US_SHR
   \   000087   E5..         MOV       A,?V0
   \   000089   A2E0         MOV       C,0xE0 /* A   */.0
   \   00008B   5017         JNC       ??crc16_x25_8
   \   00008D   75..01       MOV       ?V0,#0x1
   \   000090   75..00       MOV       ?V1,#0x0
   \   000093   740F         MOV       A,#0xf
   \   000095   C3           CLR       C
   \   000096   99           SUBB      A,R1
   \   000097   78..         MOV       R0,#?V0
   \   000099   12....       LCALL     ?S_SHL
   \   00009C   E5..         MOV       A,?V0
   \   00009E   4C           ORL       A,R4
   \   00009F   FC           MOV       R4,A
   \   0000A0   E5..         MOV       A,?V1
   \   0000A2   4D           ORL       A,R5
   \   0000A3   FD           MOV       R5,A
   \                     ??crc16_x25_8:
   \   0000A4   09           INC       R1
   \   0000A5   E9           MOV       A,R1
   \   0000A6   C3           CLR       C
   \   0000A7   9410         SUBB      A,#0x10
   \   0000A9   40D2         JC        ??crc16_x25_7
     45              return (result ^ 0xFFFF);
   \   0000AB   EC           MOV       A,R4
   \   0000AC   F4           CPL       A
   \   0000AD   FA           MOV       R2,A
   \   0000AE   ED           MOV       A,R5
   \   0000AF   F4           CPL       A
   \   0000B0   FB           MOV       R3,A
   \   0000B1   7F02         MOV       R7,#0x2
   \   0000B3   02....       LJMP      ?BANKED_LEAVE_XDATA
     46          }
     47          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
     48          uint8_t zb_generate_seqnum()
   \                     zb_generate_seqnum:
     49          {
   \   000000   C082         PUSH      DPL
   \   000002   C083         PUSH      DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
     50              static uint8_t seqnum_ = 0;
     51          
     52              return ++seqnum_;
   \   000004   90....       MOV       DPTR,#??seqnum_
   \   000007   E0           MOVX      A,@DPTR
   \   000008   04           INC       A
   \   000009   F0           MOVX      @DPTR,A
   \   00000A   F9           MOV       R1,A
   \   00000B   D083         POP       DPH
   \   00000D   D082         POP       DPL
   \   00000F   02....       LJMP      ?BRET
     53          }

   \                                 In  segment XDATA_Z, align 1, keep-with-next
   \                     ??seqnum_:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??crc16_x25::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    crc16_x25

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??zb_generate_seqnum::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zb_generate_seqnum

   Maximum stack usage in bytes:

   ISTACK XSTACK Function
   ------ ------ --------
      0     10   crc16_x25
      2      0   zb_generate_seqnum


   Segment part sizes:

   Bytes  Function/Label
   -----  --------------
     182  crc16_x25
       6  crc16_x25::?relay
       1  seqnum_
      18  zb_generate_seqnum
       6  zb_generate_seqnum::?relay

 
 200 bytes in segment BANKED_CODE
  12 bytes in segment BANK_RELAYS
   1 byte  in segment XDATA_Z
 
  12 bytes of CODE     memory
 200 bytes of HUGECODE memory
   1 byte  of XDATA    memory

Errors: none
Warnings: none
